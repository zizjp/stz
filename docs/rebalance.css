:root{
  /* Brand */
  --brand:#0A2463; --brand-2:#4055A8; --accent:#22c55e;

  /* Surface & text */
  --bg:#0b1020;
  --card:#0f152a;
  --line:rgba(255,255,255,.08);
  --fg:#e8edf7; --muted:#9aa3b2;

  /* Layout */
  --radius:16px; --pad:16px;
  --font:'Noto Sans JP', -apple-system, system-ui, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;

  /* Grid ratios（スマホ基準の%割り） */
  --col-name:58%; --col-now:26%; --col-pct:14%; --col-del:36px;
  --r-name:50%; --r-cur:12%; --r-tgt:12%; --r-amt:18%; --r-units:8%;

  /* Controls */
  --control-bg: rgba(255,255,255,.04);
  --control-bd: var(--line);
  --control-focus: 0 0 0 3px rgba(64,85,168,.25);
  --control-radius: 14px;
  --control-pad-v: 12px;
  --control-pad-h: 12px;
}

/* 基本 */
*,*::before,*::after{ box-sizing:border-box; min-width:0 }
html,body{
  margin:0;padding:0;
  background:radial-gradient(1200px 600px at 20% -10%, #142145 0%, transparent 60%), var(--bg);
  color:var(--fg);
  font-family:var(--font); font-size:16px; line-height:1.6
}
html{-webkit-text-size-adjust:100%}
a{color:inherit;text-decoration:none}

/* Appbar */
.appbar{
  position:sticky; top:0; z-index:10;
  display:flex; align-items:center; justify-content:space-between;
  padding:10px var(--pad);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border-bottom:1px solid var(--line);
  backdrop-filter:saturate(180%) blur(8px);
}
.brand{display:flex;align-items:center;gap:10px}
.brand-dot{width:10px;height:10px;border-radius:50%;
  background:conic-gradient(from 210deg, var(--brand), var(--brand-2));
  box-shadow:0 0 0 4px rgba(64,85,168,.18)}
.brand-title{font-weight:700; letter-spacing:.2px}

/* Blocks & cards */
.block{padding:0 var(--pad);margin-top:14px}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid var(--line);
  border-radius:var(--radius); padding:12px;
  box-shadow:0 8px 24px rgba(0,0,0,.28), inset 0 1px 0 rgba(255,255,255,.06);
}
.light{background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));}
.muted{color:var(--muted)}

.lbl{font-size:13px;color:var(--muted)}
.fld{display:flex;align-items:center;gap:8px}

/* 統一入力スタイル（すべての入力に適用） */
.fld input, .fld select,
.assets .asset-row input,
.asset-adv input, .asset-adv select, .asset-adv textarea{
  width:100%; max-width:100%; min-width:0;
  padding:var(--control-pad-v) var(--control-pad-h);
  border:1px solid var(--control-bd);
  border-radius:var(--control-radius);
  font-size:16px; line-height:1.3;
  background:var(--control-bg); color:var(--fg);
  outline:0; -webkit-appearance:none; appearance:none;
}
.fld input:focus, .fld select:focus,
.assets .asset-row input:focus,
.asset-adv input:focus, .asset-adv select:focus, .asset-adv textarea:focus{
  box-shadow:var(--control-focus);
  border-color:#5b7aff;
}
::placeholder{ color:var(--muted); opacity:.9 }

/* 数値スピンボタン非表示 */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0 }
input[type="number"]{ -moz-appearance:textfield }

/* 行レイアウト */
.row{display:flex;align-items:center;gap:12px;padding:8px 0}
.row .lbl{flex:0 0 42%}
.row .fld{flex:1;min-width:0}

/* ボタン */
.btn{min-height:44px;border:1px solid var(--line);background:rgba(255,255,255,.05);border-radius:12px;padding:12px 14px;color:var(--fg)}
.btn:active{transform:translateY(1px)}
.btn.primary{
  background:linear-gradient(135deg, var(--brand), var(--brand-2));
  border-color:transparent; color:#fff; font-weight:700;
  box-shadow:0 6px 20px rgba(64,85,168,.35);
}
.btn.ghost{background:rgba(255,255,255,.06)}

/* 下部アクションバー */
.fabbar{
  position:sticky;bottom:0;display:flex;gap:8px;
  padding:10px var(--pad) calc(10px + env(safe-area-inset-bottom));
  backdrop-filter:saturate(160%) blur(10px);
  background:linear-gradient(180deg, rgba(15,21,42,.6), rgba(15,21,42,.85));
  border-top:1px solid var(--line)
}

/* 入力テーブル（%割り＋固定ボタン幅） */
.assets-head,
.assets .asset-row{
  display:grid; align-items:center; gap:8px;
  grid-template-columns:
    minmax(0, var(--col-name))
    minmax(0, var(--col-now))
    minmax(0, var(--col-pct))
    var(--col-del);
}
.assets-head{color:var(--muted);font-size:12px;margin-bottom:8px}
.assets .name{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
.assets .del{
  width:var(--col-del); min-width:var(--col-del);
  padding:0; display:grid; place-items:center;
  background:rgba(255,55,55,.09); border-color:rgba(255,55,55,.2); color:#ff7676;
}

/* 詳細行（2カラム・折返しOK） */
.asset-adv{
  grid-column:1 / -1;
  display:grid; gap:10px; margin-top:-4px; margin-bottom:10px;
  grid-template-columns:minmax(0, 1fr) minmax(0, 1fr);
}
.asset-adv .small{ min-width:0; display:flex; flex-direction:column; gap:6px }
.asset-adv .small .lbl{ font-size:12px; color:var(--muted) }

/* % セグメント：-5 / -1 / +1 / +5（等分） */
.nudge{
  grid-column:1 / -1;
  display:grid; grid-template-columns:repeat(4, 1fr);
  border:1px solid var(--line); border-radius:12px; overflow:hidden;
  background:rgba(255,255,255,.04)
}
.nbtn{
  width:100%; min-height:40px;
  padding:10px 0; border:0; background:transparent; color:var(--fg); font-size:14px;
}
.nbtn:not(:first-child){ border-left:1px solid var(--line) }
.nbtn:active{ background:rgba(255,255,255,.08) }

/* スイッチ */
.switch{display:inline-grid; grid-template-columns:42px auto; align-items:center; gap:8px}
.switch input{appearance:none; -webkit-appearance:none; width:42px;height:26px;border-radius:999px; background:rgba(255,255,255,.08); position:relative; outline:0; border:1px solid var(--line)}
.switch input::after{
  content:""; position:absolute; inset:4px auto 4px 4px; width:18px; height:18px; border-radius:50%;
  background:#fff; transition:transform .18s ease; box-shadow:0 4px 10px rgba(0,0,0,.25)
}
.switch input:checked{ background:linear-gradient(135deg, #2ea265, var(--accent)); border-color:transparent }
.switch input:checked::after{ transform:translateX(16px) }
.switch .switch-label{ font-size:13px; color:var(--muted) }

/* チップ（口座/枠） */
.chip{
  display:inline-flex; align-items:center; gap:6px;
  padding:3px 8px; border-radius:999px;
  background:rgba(255,255,255,.08); color:#dae3f7; font-size:12px; border:1px solid var(--line);
}

/* サマリ／結果（%割りの固定グリッド） */
.result-head{
  display:grid; gap:8px; color:var(--muted); font-size:12px; margin-bottom:8px;
  grid-template-columns:
    minmax(0, var(--r-name))
    minmax(0, var(--r-cur))
    minmax(0, var(--r-tgt))
    minmax(0, var(--r-amt))
    minmax(0, var(--r-units));
}
.result-body .r-row{
  display:grid; gap:8px; align-items:center; margin-bottom:8px;
  grid-template-columns:
    minmax(0, var(--r-name))
    minmax(0, var(--r-cur))
    minmax(0, var(--r-tgt))
    minmax(0, var(--r-amt))
    minmax(0, var(--r-units));
}
.right{text-align:right}
.bad{ color:#ff6666; font-weight:700 }

/* 結果セル：インライン固定（長文は省略） */
.result-body .r-row > div{
  min-width:0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.result-body .r-row .num{
  font-variant-numeric: tabular-nums;
  font-feature-settings: "tnum" 1, "lnum" 1;
}
.result-body .r-row .right{ justify-self:end }

/* トースト */
.toast{
  position:fixed; left:50%; bottom:calc(12px + env(safe-area-inset-bottom));
  transform:translateX(-50%) translateY(10px);
  background:rgba(15,21,42,.9); color:#e8edf7; border:1px solid rgba(255,255,255,.12);
  padding:10px 14px; border-radius:12px; opacity:0; transition:.18s ease;
  z-index: 9999; font-size:14px; backdrop-filter:saturate(160%) blur(8px);
}
.toast.on{ transform:translateX(-50%) translateY(0); opacity:1 }

/* 幅が広いときの微調整 */
@media (min-width:640px){
  :root{
    --col-name:60%; --col-now:24%; --col-pct:12%;
    --r-name:52%; --r-cur:12%; --r-tgt:12%; --r-amt:16%; --r-units:8%;
  }
}
